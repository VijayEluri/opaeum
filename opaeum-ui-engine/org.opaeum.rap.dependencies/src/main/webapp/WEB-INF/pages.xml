<?xml version="1.0" encoding="UTF-8"?>
<pages xmlns="http://jboss.com/products/seam/pages" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://jboss.com/products/seam/pages http://jboss.com/products/seam/pages-2.2.xsd"
	no-conversation-view-id="/netranhome.xhtml">

	<page view-id="/netcmhome.xhtml" >
		<action execute="#{sessionController.appIsNetCm}" />
		<navigation from-action="#{identity.login}">
			<rule if="#{identity.loggedIn}">
				<redirect view-id="/dashboard/dashboard.xhtml">
				</redirect>
			</rule>
		</navigation>
	</page>
	
	<page view-id="/netcorehome.xhtml">
		<action execute="#{sessionController.appIsNetcore}" />
		<navigation>
			<rule if="#{identity.loggedIn}">
				<redirect view-id="/dashboard/dashboard.xhtml">
				</redirect>
			</rule>
		</navigation>		
	</page>

	<page view-id="/netranhome.xhtml">
		<action execute="#{sessionController.appIsNetran}" />
		<navigation>
			<rule if="#{identity.loggedIn}">
				<redirect view-id="/dashboard/dashboard.xhtml">
				</redirect>
			</rule>
		</navigation>
	</page>
	
	<page view-id="/dashboard/dashboard.xhtml" login-required="true">
		<action execute="#{sessionController.updateModuleStats('DASHBOARD')}" />
		<restrict>#{s:hasRole('DASHBOARD')}</restrict>
	</page>
	<page view-id="/networkgraphexplorer/networkgraphexplorer.xhtml"
		login-required="true">
		<action execute="#{sessionController.updateModuleStats('NETWORK_GRAPH')}" />
		<restrict>#{s:hasRole('NETWORK_GRAPH')}</restrict>
	</page>
	<page view-id="/elementmanager/elementmanager.xhtml"
		login-required="true">
		<action execute="#{sessionController.updateModuleStats('ELEMENT_BROWSER')}" />
		<restrict>#{s:hasRole('ELEMENT_BROWSER')}</restrict>
	</page>
	<page view-id="/reports/reports.xhtml" login-required="true">
		<action execute="#{sessionController.updateModuleStats('REPORTING')}" />
		<restrict>#{s:hasRole('REPORTING')}</restrict>
	</page>
	<page view-id="/virtualnetworkmanager/virtualnetworkmanager.xhtml"
		login-required="true">
		<action execute="#{sessionController.updateModuleStats('NETWORK_POLICY')}" />
		<restrict>#{s:hasRole('NETWORK_POLICY')}</restrict>
	</page>
	<page view-id="/networkparameterhistory/networkparameterhistory.xhtml"
		login-required="true">
		<action execute="#{sessionController.updateModuleStats('HISTORY')}" />
		<restrict>#{s:hasRole('HISTORY')}</restrict>
	</page>
	<page view-id="/virtualnetworkconfiguration/virtualnetworkconfiguration.xhtml"
		login-required="true">
		<action execute="#{sessionController.updateModuleStats('NETWORK_POLICY')}" />
		<restrict>#{s:hasRole('NETWORK_POLICY')}</restrict>
	</page>
	<page view-id="/networkstats/statsanalyser.xhtml" login-required="true">
		<action execute="#{sessionController.updateModuleStats('STATS_ANALYSER')}" />
		<restrict>#{s:hasRole('STATS_ANALYSER')}</restrict>
	</page>
	<page view-id="/nodeconnectionspec/nodeconnectionconfiguration.xhtml"
		login-required="true">
		<action execute="#{sessionController.updateModuleStats('NODE_CONNECTOR')}" />
		<restrict>#{s:hasRole('NODE_CONNECTOR')}</restrict>
	</page>
	<page view-id="/userpermissionmanager.xhtml" login-required="true">
		<action execute="#{sessionController.updateModuleStats('ADMIN')}" />
		<restrict>#{s:hasRole('ADMIN')}</restrict>
	</page>
	<page view-id="/elementmanager/bnumbermanager.xhtml" login-required="true">
		<action execute="#{sessionController.updateModuleStats('BNUMBER_MANAGER')}" />
		<restrict>#{s:hasRole('BNUMBER_MANAGER')}</restrict>
	</page>
	<page view-id="/elementmanager/tgmanager.xhtml" login-required="true">
		<action execute="#{sessionController.updateModuleStats('ABIS_MANAGER')}" />
		<restrict>#{s:hasRole('ABIS_MANAGER')}</restrict>
	</page>
	<page view-id="/elementmanager/sitemanager.xhtml" login-required="true">
		<action execute="#{sessionController.updateModuleStats('SITE_MANAGER')}" />
		<restrict>#{s:hasRole('SITE_MANAGER')}</restrict>
	</page>
	<page view-id="/userworkspacemanager/userworkspacemanager.xhtml" login-required="true">
		<action execute="#{sessionController.updateModuleStats('USER_WORKSPACE')}" />
		<restrict>#{s:hasRole('USER_WORKSPACE')}</restrict>
	</page>
	
	<page view-id="*">
		<param name="user" value="#{identity.username}" />
		<param name="sessionid" value="#{sessionController.id}" />
		<param name="app" value="#{sessionController.type}" />
		
		<navigation from-action="#{identity.logout}">
			<rule if="#{sessionController.netcore}">
				<redirect view-id="/netcorehome.xhtml" />
			</rule>
			<rule if="#{sessionController.netran}">
				<redirect view-id="/netranhome.xhtml" />
			</rule>
			<rule if="#{sessionController.netCm}">
				<redirect view-id="/netcmhome.xhtml" />
			</rule>
		</navigation>
	</page>

	<exception class="org.jboss.seam.security.NotLoggedInException">
		<redirect view-id="/netcorehome.xhtml">
			<message severity="warn">You must be logged in to use this feature</message>
		</redirect>
		
			<rule if="#{sessionController.netcore}">
				<redirect view-id="/netcorehome.xhtml" />
			</rule>
			<rule if="#{sessionController.netran}">
				<redirect view-id="/netranhome.xhtml" />
			</rule>
			<rule if="#{sessionController.netCm}">
				<redirect view-id="/netcmhome.xhtml" />
			</rule>
		
	</exception>

	<exception class="org.jboss.seam.security.AuthorizationException">
		<redirect view-id="/netcorehome.xhtml">
			<message severity="warn">You do not have sufficient rights for this action</message>
		</redirect>
	</exception>

	<exception class="javax.faces.application.ViewExpiredException">
		<redirect view-id="/netcorehome.xhtml">
			<message severity="warn">Session expired, please log in again</message>
		</redirect>
	</exception>


</pages>
